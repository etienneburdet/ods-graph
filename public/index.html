<!DOCTYPE html>
<html>

<head>
  <base href="/">

  <title>ODS Widgets Sandbox</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="https://opendatasoft.github.io/ods-widgets/dist/ods-widgets.css">
</head>

<body>

  <div class="ng-cloak" ng-app="ods-widgets">

    <ods-dataset-context
        context="cocktails"
        cocktails-dataset="cocktails"
        cocktails-domain="https://eburdet.opendatasoft.com/"
        ng-init="cardHeight = 64; cardWidth = 128; gutter = {x: 64, y:16};">
        <!--
        ****
        The base idea is to for this visualisation is to draw a grid on a an SVG canvas.
        The element are then positionned absolutely on this canvas, based on the parameters off the grid: size of the card and size and spacing (gutter)
        I strongly recommand to draw your grid with pen and paper :)
        ***
        -->
      <div ods-results="items"
        ods-results-context="cocktails"
        ng-repeat="cocktail in items"
        ng-init="ingredients = (cocktail.fields.ingredients|fromjson); canvasHeight = 0">
        <!-- Here we use one canvas per parent item, so that there is one graph per item (e.g. if there are multiple Gin cocktails, the card gin is rendered multiple times).
        If you have multiple parent items that should connect to the same children (multiple links to gin) use one SVG and iterate on row and cols. -->
        <div class="item-container">
          <div class="item">
            {{ cocktail.fields.name }}
          </div>
          <div class="sub-items">
            <div class="item-container"
              ng-repeat="ingredient in ingredients">
              <div class="link-container"
                ng-style="{'transform': 'translateY(' + 50 * (1 - $index) + '%)'}">
                <div class="link"
                ng-style="{
                  'transform': 'skewY(' + (- 90 + ($index + 1) * 180 / (ingredients.length + 1)) + 'deg)'
                }">
                </div>
              </div>
              <div class="item">
                {{ ingredient.name }}
              </div>
            </div>
          </div>
        </div>
      </div>

    </ods-dataset-context>
  </div>

  <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/angular.js/1.4.7/angular.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/angular.js/1.4.7/angular-sanitize.min.js"></script>
  <!-- <script src="//cdnjs.cloudflare.com/ajax/libs/angular.js/1.4.7/i18n/angular-locale_fr-fr.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.17.1/locale/fr.js"></script> -->
  <script type="text/javascript" src="//opendatasoft.github.io/ods-widgets/dist/ods-widgets.js"></script>

  <!-- <script type="text/javascript">
    var ods = angular.module('ods-widgets');
    ods.run(function(gettextCatalog) {
      gettextCatalog.setStrings('fr', {
        'Clear all': 'Tout effacer',
        'More': 'Voir plus',
        'Less': 'Voir moins',
        'Download image': 'Télécharger l\'image'
      });
      gettextCatalog.setCurrentLanguage('fr');
    });
  </script>

  <script type="text/javascript">
    angular.module('ods-widgets').config(function($locationProvider) {
      $locationProvider.html5Mode(true);
    });
  </script>

  <script type="text/javascript">
    angular.module('ods-widgets').config(function(ODSWidgetsConfigProvider) {
      ODSWidgetsConfigProvider.setConfig({
          "basemaps": [
            {
               "label": "Stamen",
               "provider": "stamen.toner"
            },
            {
              "url": "https://{s}.tile.thunderforest.com/landscape/{z}/{x}/{y}.png",
              "strictTMS": false,
              "provider": "custom",
              "label": "Thunderforest",
              "id": "land"
            }
          ]
          });
    });
  </script> -->

</body>

</html>
